{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Description","text":"<p>Different to traditional scale, which only show weight in scale, WSP scale can display many body indicates in the scale.</p> <p>This is the document of Server SDK.</p> <p>Current Docker version is v1.0.17.</p>"},{"location":"flow/","title":"Flow","text":"<p>Flow diagram</p>"},{"location":"docker/api/","title":"API","text":""},{"location":"docker/api/#online-test","title":"Online Test","text":"<p>Endpoint: <code>GET /yolanda/test</code></p> <p>Demo: http://wsp-sdk.yolanda.hk/yolanda/test</p>"},{"location":"docker/api/#scale-visit-docker","title":"Scale Visit Docker","text":"<p>Endpoint: <code>GET /yolanda/wsp?code=</code></p> <p>Demo: http://wsp-sdk.yolanda.hk/yolanda/wsp?code=ERROR</p>"},{"location":"docker/api/#health-check","title":"Health Check","text":"<p>Endpoint: <code>GET /yolanda/healthcheck</code></p> <p>Demo: http://wsp-sdk.yolanda.hk/yolanda/healthcheck</p>"},{"location":"docker/changelog/","title":"Changelog","text":""},{"location":"docker/changelog/#v1012-2022-01-14","title":"v1.0.12 (2022-01-14)","text":"<ul> <li>(made to order) Support control the display of indicator.</li> <li>(made to order) Support control the display of bodyfat.</li> </ul>"},{"location":"docker/changelog/#v1010-2021-01-07","title":"v1.0.10 (2021-01-07)","text":"<ul> <li>(made to order) Support upload battery level.</li> <li>(made to order) Support control the display of weight-trend.</li> </ul>"},{"location":"docker/changelog/#v109-2020-11-23","title":"v1.0.9 (2020-11-23)","text":"<ul> <li>Add more API logs and add request UUID to log.</li> <li>(made to order) Fixup negative tempatures.</li> </ul>"},{"location":"docker/changelog/#v107-2020-10-21","title":"v1.0.7 (2020-10-21)","text":"<ul> <li>Support customize the timezone of logs, use <code>TZ</code> to set timezone, default to China/Beijing.</li> <li>Support customize algorithm, default to 2.</li> <li>Performance optimize</li> </ul>"},{"location":"docker/deploy_docker_server/","title":"Deploy Server Docker","text":"<p>Server SDK is a docker image. Developer need to understand Docker.</p>"},{"location":"docker/deploy_docker_server/#generate-dockerfile","title":"Generate Dockerfile","text":"<p><code>vim Dockerfile</code></p> <pre><code>FROM registry.cn-shenzhen.aliyuncs.com/yolanda/wsp_open:v1.0.17\n</code></pre>"},{"location":"docker/deploy_docker_server/#configure-environment-variables","title":"Configure Environment Variables","text":"<p><code>vim main.env</code></p> <pre><code># [Required] Third Server URL\nWSP_DOMAIN=http://wsp-demo.yolanda.hk\n\n# [Optional] Authorization header, default to nil\nAUTHORIZATION=\"Basic ZHVtbXk6MTIzNDU2Nzg=\"\n\n# [Optional] Custom OTA Server, default to Yolanda OTA Sever\nCUSTOM_OTA_SERVER=http://wsp-demo.yolanda.hk\n\n# [Optional] Custom Alogrithm, default to 01\nCUSTOM_ALGORITHM=01\n\n# [Optional] Listen port, default to 3000\nPORT=3000\n\n# [Optional] Timezone, default to Asia/Shanghai\nTZ=Asia/Shanghai\n</code></pre>"},{"location":"docker/deploy_docker_server/#run-docker-container","title":"Run Docker Container","text":"<pre><code>docker build . -t wsp_server\ndocker run --env-file main.env wsp_server\n# docker run --env-file main.env wsp_server -d # Start on background\n</code></pre>"},{"location":"third_server/deploy_third_server/","title":"Deploy","text":"<p>Third Server can be written  in any programming languages</p> <p>The endpoints from Docker are required. </p> <p>The endpoints from APP are optional, decided by developer.</p>"},{"location":"third_server/ota/","title":"OTA","text":""},{"location":"third_server/ota/#ota","title":"OTA","text":"<p>The Scale can upgrade via BLE or Wifi.</p> <p>We will send an upgrade package to you.</p> <p>And we will offer four data that you should configure it in your Server: </p> <ul> <li>Internal Model: The model of your device</li> <li>Hardware Model: The chip model of your device</li> <li>Version: The version of upgrade package</li> <li>File Checksum(8 chars): The checksum of upgrade package</li> </ul>"},{"location":"third_server/ota/#show-ota-versionsapp-your-server","title":"Show Ota Versions(App -&gt; Your Server)","text":"<p>Endpoint: <code>POST /api/v1/ota_versions/show_ota_version</code></p> <p>Body Params</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC internal_model string Yes Internal Model mock: 029A hardware_model string Yes Hardware Model mock: 0001 version integer Yes Current Version mock: 1 <p>Return Params</p> Name Type Required Remark Other can_upgrade boolean Yes Ota Versions mock: true upgrade_url string Yes Upgrade Url mock: http://your-server-domain.com/AN_URL_CAN_DOWNLOAD"},{"location":"third_server/ota/#read-ota-versionsdocker-your-server","title":"Read Ota Versions(Docker -&gt; Your Server)","text":"<p>Endpoint: <code>POST /wsp/read_ota_versions</code></p> <p>Body Params</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC internal_model string Yes Internal Model mock: 029A hardware_model string Yes Hardware Model mock: 0001 version integer Yes Current Version mock: 1 <p>Return Params</p> Name Type Required Remark Other ota_versions object [] Yes Ota Versions item type: object \u251c\u2500 internal_model string Yes Internal Model mock: 029A \u251c\u2500 hardware_model string Yes Hardware Model mock: 0001 \u251c\u2500 version integer Yes Version mock: 6 \u251c\u2500 crc string Yes File Checksum(8 chars) mock: AABBCCDD"},{"location":"third_server/request_by_app/","title":"Request from APP","text":""},{"location":"third_server/request_by_app/#scale-users","title":"Scale Users","text":""},{"location":"third_server/request_by_app/#apply-key","title":"Apply Key","text":"<p>Endpoint: <code>POST /api/v1/scale_users/apply_key</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC user_id String Yes User ID <p>Return Params:</p> Name Type Required Remark key String Yes Key <p>Request Example:</p> <pre><code>{\n\"mac\": \"12:34:56:78:9A:BC\",\n\"user_id\": 100\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n\"key\": 7181\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#create-scale-user","title":"Create Scale User","text":"<p>Endpoint: <code>POST /api/v1/scale_users/create_scale_user</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC user_id String Yes User ID index Integer Yes User Index key Integer Yes Key <p>Return Params: None</p> <p>Request Example:</p> <pre><code>{\n\"mac\": \"F7:53:C8:C5:2B:86\",\n\"user_id\": 200,\n\"index\": 7,\n\"key\": 200\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#delete-scale-user","title":"Delete Scale User","text":"<p>Endpoint: <code>POST /api/v1/scale_users/delete_scale_user</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC scale_user_ids String Yes Scale User IDs, split by comma <p>Return Params: None</p> <p>Request Example:</p> <pre><code>{\n\"mac\": \"12:34:56:78:9A:BC\",\n\"scale_user_ids\": \"100,100\"\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#list-need-delete-user","title":"List Need Delete User","text":"<p>Endpoint: <code>GET /api/v1/scale_users/list_need_delete_user</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC <p>Return Params:</p> Name Type Required Remark scale_users Array Yes Scale Users <p>Request Example:</p> <pre><code>{\n\"mac\": \"12:34:56:78:9A:BC\"\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n\"scale_users\": [\n{\n\"scale_user_id\": \"200\",\n\"user_id\": \"200\",\n\"mac\": \"12:34:56:78:9A:BC\",\n\"index\": 2,\n\"key\": 9999\n}\n]\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#list-scale-user","title":"List Scale User","text":"<p>Endpoint: <code>GET /api/v1/scale_users/list_scale_user</code></p> <p>Body Params: None</p> <p>Return Params:</p> Name Type Required Remark scale_users Array Yes Scale Users <p>Request Example: None</p> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n\"scale_users\": [\n{\n\"scale_user_id\": \"200\",\n\"user_id\": \"200\",\n\"mac\": \"12:34:56:78:9A:BC\",\n\"index\": 2,\n\"key\": 9999\n},\n{\n\"scale_user_id\": \"100\",\n\"user_id\": \"100\",\n\"mac\": \"12:34:56:78:9A:BC\",\n\"index\": 1,\n\"key\": 1000\n}\n]\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#wsp-scale","title":"WSP Scale","text":""},{"location":"third_server/request_by_app/#apply-network-info","title":"Apply Network Info","text":"<p>Endpoint: <code>POST /api/v1/scales/apply_network_info</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC scale_name String Yes Scale Name internal_model String Yes Internal Model <p>Return Params:</p> Name Type Required Remark server_url String Yes Server URL ota_url String Yes Ota URL secret_key String Yes Secret Key <p>Request Example:</p> <pre><code>{\n\"mac\": \"F7:53:C8:C5:2B:86\",\n\"scale_name\": \"QN-Scale\",\n\"internal_model\": \"0152\"\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n\"server_url\": \"http://wsp.yolanda.hk:80/wifi_api/wsps?code=\",\n\"ota_url\": \"https://otaurl.yolanda.hk\",\n\"secret_key\": \"OQnuVdVk8zH5vTmb\"\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#check-firmware-version","title":"Check Firmware Version","text":"<p>Endpoint: <code>GET /api/v1/scales/check_firmware_version</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC internal_model String Yes Internal Model hardware_model Integer Yes Hardware Model current_firmware_version Integer Yes Current Firmware Version <p>Return Params:</p> Name Type Required Remark new_firmware_version_flag Integer Yes Is New Firmware Version Present? <p>Request Example:</p> <pre><code>{\n\"mac\": \"12:34:56:78:9A:BC\",\n\"internal_model\": \"0001\",\n\"hardware_model\": 2,\n\"current_firmware_version\": 2\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n\"new_firmware_version_flag\": 1\n}\n}\n</code></pre>"},{"location":"third_server/request_by_app/#update-secret-key","title":"Update Secret Key","text":"<p>Endpoint: <code>POST /api/v1/scales/update_secret_key</code></p> <p>Body Params:</p> Name Type Required Remark mac String Yes MAC secret_key String Yes Secret Key <p>Return Params: None</p> <p>Request Example:</p> <pre><code>{\n\"mac\": \"12:34:56:78:9A:BC\",\n\"secret_key\": \"ti3FaD4bKcP3lQI2\"\n}\n</code></pre> <p>Response Example:</p> <pre><code>{\n\"code\": \"200\",\n\"msg\": \"ok\",\n\"data\": {\n}\n}\n</code></pre>"},{"location":"third_server/request_by_docker/","title":"Request from Docker","text":""},{"location":"third_server/request_by_docker/#general-command","title":"General Command","text":""},{"location":"third_server/request_by_docker/#read-secret-key","title":"Read Secret Key","text":"<p>Endpoint: <code>POST /wsp/read_secret_key</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params:</p> Name Type Required Remark Other secret_key string Yes Secret key of scale (16 charaters, blank must be '') mock: 123456789ABCDEFG"},{"location":"third_server/request_by_docker/#0x20","title":"0x20","text":""},{"location":"third_server/request_by_docker/#read-scale-users","title":"Read Scale Users","text":"<p>Endpoint: <code>POST /wsp/read_scale_users</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params:</p> Name Type Required Remark Other scale_users object [] Yes Scale Users(blank is []) item type: object \u251c\u2500 user_index integer Yes User Index(1-8) mock: 2 \u251c\u2500 gender integer Yes Gender 0 female 1 male mock: 1 \u251c\u2500 height number Yes Height(cm, keep a decimal fraction) mock: 180.5 \u251c\u2500 birthday string Yes Birthday(YYYY-mm-dd format) mock: 1990-01-01 \u251c\u2500 user_key integer Yes User Key(1000-9999) mock: 1234 \u251c\u2500 algorithm integer Yes Algorithm mock: 1 \u251c\u2500 sport_flag integer Yes Use Sport mode? use is 1, unused is 0. mock: 1 unit integer Yes Unit 1 kg 2 lb 4 \u65a4 mock: 1"},{"location":"third_server/request_by_docker/#made-to-order-read-bow-scale-users","title":"(made to order) Read Bow Scale Users","text":"<p>Endpoint: <code>POST /wsp/read_bow_scale_users</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC battery_level integer YES Battery Level 0-Disabled 1-Low 2-Working 4-Full mock: 1 <p>Return Params:</p> Name Type Required Remark Other scale_users object [] Yes Scale Users(blank is []) item type: object \u251c\u2500 user_index integer Yes User Index(1-8) mock: 2 \u251c\u2500 gender integer Yes Gender 0 female 1 male mock: 1 \u251c\u2500 height number Yes Height(cm, keep a decimal fraction) mock: 180.5 \u251c\u2500 birthday string Yes Birthday(YYYY-mm-dd format) mock: 1990-01-01 \u251c\u2500 user_key integer Yes User Key(1000-9999) mock: 1234 unit integer Yes Unit 1 kg 2 lb 4 \u65a4 mock: 1 ctrl integer Yes 1 means display, 0 means hidden # Bit0-&gt;username Bit1-&gt;BMI Bit2-&gt;bone Bit3-&gt;bodyfat Bit4-&gt;sinew Bit5-&gt;water Bit6-&gt;heart rate Bit7-&gt;weather Bit8-&gt;weight-trend mock: 511"},{"location":"third_server/request_by_docker/#made-to-order-read-qardio-scale-users","title":"(made to order) Read Qardio Scale Users","text":"<p>Endpoint: <code>POST /wsp/read_qardio_scale_users</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params:</p> Name Type Required Remark Other scale_users object [] Yes Scale Users(blank is []) item type: object \u251c\u2500 user_index integer Yes User Index(1-8) mock: 2 \u251c\u2500 gender integer Yes Gender 0 female 1 male mock: 1 \u251c\u2500 height number Yes Height(cm, keep a decimal fraction) mock: 180.5 \u251c\u2500 last_weight number Yes Weight(the weight last measured) mock: 65.5 \u251c\u2500 birthday string Yes Birthday(YYYY-mm-dd format) mock: 1990-01-01 \u251c\u2500 user_key integer Yes User Key(1000-9999) mock: 1234 \u251c\u2500 ctrl integer Yes 1 means display, 0 means hidden # Bit0-&gt;bodyfat Bit1-&gt;indicator mock: 255 \u251c\u2500 sport_flag integer Yes Use Sport mode? use is 1, unused is 0. mock: 1 unit integer Yes Unit 1 kg 2 lb 4 \u65a4 mock: 1"},{"location":"third_server/request_by_docker/#read-ota-versions","title":"Read Ota Versions","text":"<p>Endpoint: <code>POST /wsp/read_ota_versions</code></p> <p>Body Params</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params</p> Name Type Required Remark Other ota_versions object [] Yes Ota Versions item type: object \u251c\u2500 internal_model string Yes Internal Model mock: 029A \u251c\u2500 hardware_model string Yes Hardware Model mock: 0001 \u251c\u2500 version integer Yes Version mock: 6 \u251c\u2500 crc string Yes File Checksum(8 chars) mock: AABBCCDD"},{"location":"third_server/request_by_docker/#0x21","title":"0x21","text":""},{"location":"third_server/request_by_docker/#create-unknown-measurement","title":"Create Unknown Measurement","text":"<p>Endpoint: <code>POST /wsp/create_unknown_measurement</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC model_id string Yes Model ID(4 chars) mock: 0E2B weight number Yes Weight mock: 50.0 timestamp integer Yes Timestamp(Seconds) mock: 1582698882 heart_rate integer Yes Heart Rate mock: 93 resistance integer Yes 50k Resistance mock: 500 sec_resistance integer Yes 500k Resistance mock: 500 hmac string Yes Signature(Hmac) mock: Hmac <p>Return Params:</p> Name Type Required Remark Other is_success boolean Yes Is Success mock: true"},{"location":"third_server/request_by_docker/#create-measurement","title":"Create Measurement","text":"<p>Endpoint: <code>POST /wsp/create_measurement</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC model _id string Yes Model ID mock: 00EA user_index integer Yes User Index mock: 1 weight number Yes Weight mock: 50.0 timestamp integer Yes Timestamp(Seconds) mock: 1582698882 heart_rate integer Yes Heart Rate mock: 93 resistance integer Yes 50k Resistance mock: 500 sec_resistance integer Yes 500k Resistance mock: 500 bmi integer Yes BMI mock: 21.1 bodyfat number Yes Body Fat mock: 27.6 body_shape integer Yes Body Shape mock: 4 fat_free_weight number Yes Fat Free Weight mock: 39.11 subfat number Yes Subcutaneous Fat mock: 25.8 visfat integer Yes Visceral Fat Level mock: 4 water number Yes Body Water mock: 49.7 muscle number Yes Skeletal Muscle mock: 42.2 sinew number Yes Muscle Mass mock: 36.75 bone number Yes Bone Mass (inorganic salt) mock: 2.35 protein number Yes Protein mock: 16.98 bmr integer Yes BMR mock: 1214 bodyage integer Yes Body Age mock: 27 score number Yes Score mock: 91.9 cardiac_index number Yes Cardiac Index mock: 2.7 hmac string Yes Signature(Hmac) mock: sfsfsffdsvsdvsd <p>Return Params:</p> Name Type Required Remark Other is_success boolean Yes Is Success mock: true"},{"location":"third_server/request_by_docker/#0x22","title":"0x22","text":""},{"location":"third_server/request_by_docker/#finish-info-sync","title":"Finish Info Sync","text":"<p>Endpoint: <code>POST /wsp/finish_info_sync</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params:</p> Name Type Required Remark Other is_success boolean Yes Is Success mock: true"},{"location":"third_server/request_by_docker/#0x27","title":"0x27","text":""},{"location":"third_server/request_by_docker/#read-scale-users-with-weight","title":"Read Scale Users With Weight","text":"<p>Endpoint: <code>POST /wsp/read_weight_scale_users</code></p> <p>Body Params:</p> Name Type Required Remark Other mac string Yes MAC mock: 12:34:56:78:9A:BC <p>Return Params:</p> Name Type Required Remark Other scale_users object [] Yes Scale Users(blank is []) item type: object \u251c\u2500 user_index integer Yes User Index(1-8) mock: 2 \u251c\u2500 gender integer Yes Gender 0 female 1 male mock: 1 \u251c\u2500 height number Yes Height(cm, keep a decimal fraction) mock: 180.5 \u251c\u2500 weight number Yes Weight(keep a decimal fraction) mock: 67.5 \u251c\u2500 weight_goal number Yes Weight Goal(keep a decimal fraction) mock: 65.0 \u251c\u2500 birthday string Yes Birthday(YYYY-mm-dd format) mock: 1990-01-01 \u251c\u2500 user_key integer Yes User Key(1000-9999) mock: 1234 unit integer Yes Unit 1 kg 2 lb 4 \u65a4 mock: 1"}]}